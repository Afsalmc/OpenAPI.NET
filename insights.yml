swagger: '2.0'
info:
  title: ApplicationInsightsClient
  description: This document describes the protocol for client requests and responses to the data collection endpoint.
  version: 2020-09-15_Preview
paths:
  /track:
    post:
      summary: Track telemetry events
      description: This operation sends a sequence of telemetry events that will be monitored by Azure Monitor.
      operationId: track
      consumes:
        - application/json
        - x-json-stream
      produces:
        - application/json
      parameters:
        - in: body
          name: body
          description: The list of telemetry events to track.
          required: true
          schema:
            type: array
            items:
              $ref: '#/definitions/TelemetryEnvelope'
      responses:
        '200':
          description: All of the telemetry items were accepted and processed.
          schema:
            $ref: '#/definitions/TrackResponse'
        '206':
          description: Partial success. Some of the telemetry items were accepted and processed.
          schema:
            $ref: '#/definitions/TrackResponse'
        '400':
          description: Bad Request
          schema:
            $ref: '#/definitions/TrackResponse'
          x-ms-error-response: true
        '402':
          description: Payment Required
          schema:
            $ref: '#/definitions/TrackResponse'
          x-ms-error-response: true
        '429':
          description: Too Many Requests
          schema:
            $ref: '#/definitions/TrackResponse'
          x-ms-error-response: true
        '500':
          description: Internal Server Error
          schema:
            $ref: '#/definitions/TrackResponse'
          x-ms-error-response: true
        '503':
          description: Service Unavailable
          schema:
            $ref: '#/definitions/TrackResponse'
          x-ms-error-response: true
      x-ms-examples:
        Track examples:
          $ref: examples/track.json
definitions:
  AvailabilityData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: Instances of AvailabilityData represent the result of executing an availability test.
        required:
          - id
          - name
          - duration
          - success
        type: object
        properties:
          id:
            description: Identifier of a test run. Use it to correlate steps of test run and telemetry generated by the service.
            maxLength: 512
            type: string
          name:
            description: Name of the test that these availability results represent.
            maxLength: 1024
            type: string
          duration:
            description: 'Duration in format: DD.HH:MM:SS.MMMMMM. Must be less than 1000 days.'
            type: string
          success:
            description: Success flag.
            type: boolean
            x-nullable: false
          runLocation:
            description: Name of the location where the test was run from.
            maxLength: 1024
            type: string
          message:
            description: Diagnostic message for the result.
            maxLength: 8192
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  Base:
    description: Data struct to contain only C section with custom fields.
    type: object
    properties:
      baseType:
        description: 'Name of item (B section) if any. If telemetry data is derived straight from this, this should be null.'
        type: string
      baseData:
        $ref: '#/definitions/Domain'
    x-ms-client-name: MonitorBase
  DataPoint:
    description: Metric data single measurement.
    required:
      - name
      - value
    type: object
    properties:
      ns:
        description: Namespace of the metric.
        maxLength: 256
        type: string
        x-ms-client-name: namespace
      name:
        description: Name of the metric.
        maxLength: 1024
        type: string
      kind:
        $ref: '#/definitions/DataPointType'
      value:
        format: double
        description: Single value for measurement. Sum of individual measurements for the aggregation.
        type: number
      count:
        format: int32
        description: Metric weight of the aggregated metric. Should not be set for a measurement.
        type: number
        x-nullable: true
      min:
        format: double
        description: Minimum value of the aggregated metric. Should not be set for a measurement.
        type: number
        x-nullable: true
      max:
        format: double
        description: Maximum value of the aggregated metric. Should not be set for a measurement.
        type: number
        x-nullable: true
      stdDev:
        format: double
        description: Standard deviation of the aggregated metric. Should not be set for a measurement.
        type: number
        x-nullable: true
    x-ms-client-name: MetricDataPoint
  DataPointType:
    description: Type of the metric data measurement.
    enum:
      - Measurement
      - Aggregation
    type: string
  Domain:
    description: The abstract common base of all domains.
    required:
      - ver
    type: object
    properties:
      ver:
        format: int32
        description: Schema version
        default: 2
        type: integer
        x-ms-client-name: version
    x-ms-client-name: MonitorDomain
  EventData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: Instances of Event represent structured event records that can be grouped and searched by their properties. Event data item also creates a metric of event count by name.
        required:
          - name
        type: object
        properties:
          name:
            description: Event name. Keep it low cardinality to allow proper grouping and useful metrics.
            maxLength: 512
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
    x-ms-client-name: TelemetryEventData
  ExceptionData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: An instance of Exception represents a handled or unhandled exception that occurred during execution of the monitored application.
        required:
          - exceptions
        type: object
        properties:
          exceptions:
            description: Exception chain - list of inner exceptions.
            type: array
            items:
              $ref: '#/definitions/ExceptionDetails'
          severityLevel:
            $ref: '#/definitions/SeverityLevel'
          problemId:
            description: Identifier of where the exception was thrown in code. Used for exceptions grouping. Typically a combination of exception type and a function from the call stack.
            maxLength: 1024
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
    x-ms-client-name: TelemetryExceptionData
  ExceptionDetails:
    description: Exception details of the exception in a chain.
    required:
      - message
    type: object
    properties:
      id:
        format: int32
        description: 'In case exception is nested (outer exception contains inner one), the id and outerId properties are used to represent the nesting.'
        type: number
      outerId:
        format: int32
        description: The value of outerId is a reference to an element in ExceptionDetails that represents the outer exception
        type: number
      typeName:
        description: Exception type name.
        maxLength: 1024
        type: string
      message:
        description: Exception message.
        maxLength: 32768
        type: string
      hasFullStack:
        description: 'Indicates if full exception stack is provided in the exception. The stack may be trimmed, such as in the case of a StackOverflow exception.'
        default: true
        type: boolean
      stack:
        description: Text describing the stack. Either stack or parsedStack should have a value.
        maxLength: 32768
        type: string
      parsedStack:
        description: List of stack frames. Either stack or parsedStack should have a value.
        type: array
        items:
          $ref: '#/definitions/StackFrame'
    x-ms-client-name: TelemetryExceptionDetails
  MessageData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: 'Instances of Message represent printf-like trace statements that are text-searched. Log4Net, NLog and other text-based log file entries are translated into instances of this type. The message does not have measurements.'
        required:
          - message
        type: object
        properties:
          message:
            description: Trace message
            maxLength: 32768
            type: string
          severityLevel:
            $ref: '#/definitions/SeverityLevel'
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  MetricsData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: An instance of the Metric item is a list of measurements (single data points) and/or aggregations.
        required:
          - metrics
        type: object
        properties:
          metrics:
            description: List of metrics. Only one metric in the list is currently supported by Application Insights storage. If multiple data points were sent only the first one will be used.
            type: array
            items:
              $ref: '#/definitions/DataPoint'
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
  PageViewData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: An instance of PageView represents a generic action on a page like a button click. It is also the base type for PageView.
        required:
          - id
          - name
        type: object
        properties:
          id:
            description: Identifier of a page view instance. Used for correlation between page view and other telemetry items.
            maxLength: 512
            type: string
          name:
            description: Event name. Keep it low cardinality to allow proper grouping and useful metrics.
            maxLength: 1024
            type: string
          url:
            description: Request URL with all query string parameters
            maxLength: 2048
            type: string
          duration:
            description: 'Request duration in format: DD.HH:MM:SS.MMMMMM. For a page view (PageViewData), this is the duration. For a page view with performance information (PageViewPerfData), this is the page load time. Must be less than 1000 days.'
            type: string
          referredUri:
            description: 'Fully qualified page URI or URL of the referring page; if unknown, leave blank'
            maxLength: 2048
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  PageViewPerfData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: 'An instance of PageViewPerf represents: a page view with no performance data, a page view with performance data, or just the performance data of an earlier page request.'
        required:
          - id
          - name
        type: object
        properties:
          id:
            description: Identifier of a page view instance. Used for correlation between page view and other telemetry items.
            maxLength: 512
            type: string
          name:
            description: Event name. Keep it low cardinality to allow proper grouping and useful metrics.
            maxLength: 1024
            type: string
          url:
            description: Request URL with all query string parameters
            maxLength: 2048
            type: string
          duration:
            description: 'Request duration in format: DD.HH:MM:SS.MMMMMM. For a page view (PageViewData), this is the duration. For a page view with performance information (PageViewPerfData), this is the page load time. Must be less than 1000 days.'
            type: string
          perfTotal:
            description: 'Performance total in TimeSpan ''G'' (general long) format: d:hh:mm:ss.fffffff'
            type: string
          networkConnect:
            description: 'Network connection time in TimeSpan ''G'' (general long) format: d:hh:mm:ss.fffffff'
            type: string
          sentRequest:
            description: 'Sent request time in TimeSpan ''G'' (general long) format: d:hh:mm:ss.fffffff'
            type: string
          receivedResponse:
            description: 'Received response time in TimeSpan ''G'' (general long) format: d:hh:mm:ss.fffffff'
            type: string
          domProcessing:
            description: 'DOM processing time in TimeSpan ''G'' (general long) format: d:hh:mm:ss.fffffff'
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  RemoteDependencyData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: An instance of Remote Dependency represents an interaction of the monitored component with a remote component/service like SQL or an HTTP endpoint.
        required:
          - name
          - duration
        type: object
        properties:
          id:
            description: Identifier of a dependency call instance. Used for correlation with the request telemetry item corresponding to this dependency call.
            maxLength: 512
            type: string
          name:
            description: Name of the command initiated with this dependency call. Low cardinality value. Examples are stored procedure name and URL path template.
            maxLength: 1024
            type: string
          resultCode:
            description: Result code of a dependency call. Examples are SQL error code and HTTP status code.
            maxLength: 1024
            type: string
          data:
            description: Command initiated by this dependency call. Examples are SQL statement and HTTP URL with all query parameters.
            maxLength: 8192
            type: string
          type:
            description: 'Dependency type name. Very low cardinality value for logical grouping of dependencies and interpretation of other fields like commandName and resultCode. Examples are SQL, Azure table, and HTTP.'
            maxLength: 1024
            type: string
          target:
            description: 'Target site of a dependency call. Examples are server name, host address.'
            maxLength: 1024
            type: string
          duration:
            description: 'Request duration in format: DD.HH:MM:SS.MMMMMM. Must be less than 1000 days.'
            type: string
          success:
            description: Indication of successful or unsuccessful call.
            default: true
            type: boolean
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  RequestData:
    allOf:
      - $ref: '#/definitions/Domain'
      - description: An instance of Request represents completion of an external request to the application to do work and contains a summary of that request execution and the results.
        required:
          - id
          - duration
          - responseCode
          - success
        type: object
        properties:
          id:
            description: Identifier of a request call instance. Used for correlation between request and other telemetry items.
            maxLength: 512
            type: string
          name:
            description: 'Name of the request. Represents code path taken to process request. Low cardinality value to allow better grouping of requests. For HTTP requests it represents the HTTP method and URL path template like ''GET /values/{id}''.'
            maxLength: 1024
            type: string
          duration:
            description: 'Request duration in format: DD.HH:MM:SS.MMMMMM. Must be less than 1000 days.'
            type: string
          success:
            description: Indication of successful or unsuccessful call.
            default: true
            type: boolean
          responseCode:
            description: Result of a request execution. HTTP status code for HTTP requests.
            maxLength: 1024
            type: string
          source:
            description: Source of the request. Examples are the instrumentation key of the caller or the ip address of the caller.
            maxLength: 1024
            type: string
          url:
            description: Request URL with all query string parameters.
            maxLength: 2048
            type: string
          properties:
            description: Collection of custom properties.
            type: object
            additionalProperties:
              maxLength: 8192
              type: string
          measurements:
            description: Collection of custom measurements.
            type: object
            additionalProperties:
              format: double
              type: number
  SeverityLevel:
    description: Defines the level of severity for the event.
    enum:
      - Verbose
      - Information
      - Warning
      - Error
      - Critical
    type: string
  StackFrame:
    description: Stack frame information.
    required:
      - level
      - method
    type: object
    properties:
      level:
        format: int32
        description: ''
        type: number
      method:
        description: Method name.
        maxLength: 1024
        type: string
      assembly:
        description: 'Name of the assembly (dll, jar, etc.) containing this function.'
        maxLength: 1024
        type: string
      fileName:
        description: File name or URL of the method implementation.
        maxLength: 1024
        type: string
      line:
        format: int32
        description: Line number of the code implementation.
        type: number
  TrackResponse:
    description: Response containing the status of each telemetry item.
    type: object
    properties:
      itemsReceived:
        format: int32
        description: The number of items received.
        type: number
      itemsAccepted:
        format: int32
        description: The number of items accepted.
        type: number
      errors:
        description: An array of error detail objects.
        type: array
        items:
          $ref: '#/definitions/ErrorDetails'
  ErrorDetails:
    description: The error details
    type: object
    properties:
      index:
        format: int32
        description: The index in the original payload of the item.
        type: number
      statusCode:
        format: int32
        description: 'The item specific [HTTP Response status code](#Response Status Codes).'
        type: number
      message:
        description: The error message.
        type: string
    x-ms-client-name: TelemetryErrorDetails
  TelemetryEnvelope:
    description: System variables for a telemetry item.
    required:
      - name
      - time
    type: object
    properties:
      ver:
        format: int32
        description: 'Envelope version. For internal use only. By assigning this the default, it will not be serialized within the payload unless changed to a value other than #1.'
        default: 1
        type: number
        x-ms-client-name: version
      name:
        description: Type name of telemetry data item.
        type: string
      time:
        format: date-time
        description: 'Event date time when telemetry item was created. This is the wall clock time on the client when the event was generated. There is no guarantee that the client''s time is accurate. This field must be formatted in UTC ISO 8601 format, with a trailing ''Z'' character, as described publicly on https://en.wikipedia.org/wiki/ISO_8601#UTC. Note: the number of decimal seconds digits provided are variable (and unspecified). Consumers should handle this, i.e. managed code consumers should not use format ''O'' for parsing as it specifies a fixed length. Example: 2009-06-15T13:45:30.0000000Z.'
        type: string
      sampleRate:
        format: float
        description: Sampling rate used in application. This telemetry item represents 100 / sampleRate actual telemetry items.
        default: 100
        type: number
      seq:
        description: Sequence field used to track absolute order of uploaded events.
        maxLength: 64
        type: string
        x-ms-client-name: sequence
      iKey:
        description: The instrumentation key of the Application Insights resource.
        type: string
        x-ms-client-name: instrumentationKey
      tags:
        description: Key/value collection of context properties. See ContextTagKeys for information on available properties.
        type: object
        additionalProperties:
          type: string
      data:
        $ref: '#/definitions/Base'
    x-ms-client-name: TelemetryItem
  ContextTagKeys:
    description: The context tag keys.
    enum:
      - ApplicationVersion
      - DeviceId
      - DeviceLocale
      - DeviceModel
      - DeviceOEMName
      - DeviceOSVersion
      - DeviceType
      - LocationIp
      - LocationCountry
      - LocationProvince
      - LocationCity
      - OperationId
      - OperationName
      - OperationParentId
      - OperationSyntheticSource
      - OperationCorrelationVector
      - SessionId
      - SessionIsFirst
      - UserAccountId
      - UserId
      - UserAuthUserId
      - CloudRole
      - CloudRoleVer
      - CloudRoleInstance
      - CloudLocation
      - InternalSdkVersion
      - InternalAgentVersion
      - 'InternalNodeName  '
    type: string
    x-ms-enum:
      name: ContextTagKeys
      modelAsString: true
      values:
        - value: ai.application.ver
        - value: ai.device.id
        - value: ai.device.locale
        - value: ai.device.model
        - value: ai.device.oemName
        - value: ai.device.osVersion
        - value: ai.device.type
        - value: ai.location.ip
        - value: ai.location.country
        - value: ai.location.province
        - value: ai.location.city
        - value: ai.operation.id
        - value: ai.operation.name
        - value: ai.operation.parentId
        - value: ai.operation.syntheticSource
        - value: ai.operation.correlationVector
        - value: ai.session.id
        - value: ai.session.isFirst
        - value: ai.user.accountId
        - value: ai.user.id
        - value: ai.user.authUserId
        - value: ai.cloud.role
        - value: ai.cloud.roleVer
        - value: ai.cloud.roleInstance
        - value: ai.cloud.location
        - value: ai.internal.sdkVersion
        - value: ai.internal.agentVersion
        - value: ai.internal.nodeName
parameters:
  Host:
    in: path
    name: Host
    description: 'Breeze endpoint: https://dc.services.visualstudio.com'
    required: true
    type: string
    default: https://dc.services.visualstudio.com
    x-ms-parameter-location: client
    x-ms-skip-url-encoding: true
x-ms-parameterized-host:
  hostTemplate: '{Host}/v2'
  useSchemePrefix: false
  parameters:
    - $ref: '#/parameters/Host'